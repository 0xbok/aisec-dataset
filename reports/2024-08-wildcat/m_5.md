## [M] Role providers can bypass intended restrictions and lower expiry set by other providers

[FixedTermLoanHooks.sol#L413](repos/2024-08-wildcat/src/access/FixedTermLoanHooks.sol#L413)

If we look at the code comments, we'll see that role providers can update a user's credential only if at least one of the 3 is true:

*   the previous credential's provider is no longer supported, OR
*   the caller is the previous role provider, OR
*   the new expiry is later than the current expiry

[FixedTermLoanHooks.sol#L404-L419](src/access/FixedTermLoanHooks.sol#L404-L419):
```solidity
  /**
   * @dev Grants a role to an account by updating the account's status.
   *      Can only be called by an approved role provider.
   *
   *      If the account has an existing credential, it can only be updated if:
   *      - the previous credential's provider is no longer supported, OR
   *      - the caller is the previous role provider, OR
   *      - the new expiry is later than the current expiry
   */
  function grantRole(address account, uint32 roleGrantedTimestamp) external {
    RoleProvider callingProvider = _roleProviders[msg.sender];

    if (callingProvider.isNull()) revert ProviderNotFound();

    _grantRole(callingProvider, account, roleGrantedTimestamp);
  }
```

This means that a role provider should not be able to reduce a credential set by another role provider.

However, this could easily be bypassed by simply splitting the call into 2 separate ones:

1.  First one to set the expiry slightly later than the currently set one. This would set the role provider to the new one.
2.  Second call to reduce the expiry as much as they'd like. Since they're the previous provider they can do that.



