## [M] RToken can manipulate distribution to avoid paying DAO fees

Revenue produced by RTokens is sold for both RSR and RTokens according to a distribution defined in the [`Distributor`](relative_path_091409:contracts/p1/Distributor.sol). The `BackingManager` [splits](relative_path_091409:contracts/p1/BackingManager.sol#L247-L261) the collateral tokens to be sold proportionately to the RSR/RToken distribution ratio and sends them to the `rsrTrader` and `rTokenTrader`. When trades settle, the obtained RSR or RTokens are sent to the `Distributor`, which distributes them no longer according to the RSR/RToken ratio but to the different destinations for the specific token. The sum of all destinations for each token is used to derive the ratio.

The DAO fee is added to the RSR share of the initial split and paid when RSR is distributed.

However, the current implementation allows governance to manipulate the distribution settings without much effort in a way that can significantly reduce the amount of DAO fees paid.

This can be achieved through a combination of two different root causes:

*   an RSR destination can be added that prevents rewards from being immediately distributed
*   the RSR/RToken ratio is calculated twice: once in the  `BackingManager`, and once in the `Distributor`, and it is can be modified between the two

Essentially, the distribution can be set in a way that temporarily accumulates RSR revenue in in the `rsrTrader` according to one RSR/RToken ratio, and then later redistributed with a different ratio.

### Impact

RTokens can avoid paying most of the DAO fee

### Proof of Concept

Assuming a 10% DAO fee, governance can execute the following steps to pay only about 1% in fees:

1.  Set the distribution such that `rsrTotal == 0` before DAO fees [are added](relative_path_091409:contracts/p1/Distributor.sol#L221).
2.  Add the RSR token itself as a distribution target. Like stRSR, [RSR](https://etherscan.io/token/0x320623b8e4ff03373931769a31fc52a4e78b5d70#code) does not allow transferring to itself, so the distribution will always fail.
3.  10% of revenue will accumulate as RSR in the `rsrTrader`.
4.  After some time, change the distribution such that `rTokenTotal == 0` and add another destination with non-zero `rsrDist` (e.g., `stRSR`).
5.  Remove RSR as a distribution target and call `rsrTrader.distributeTokenToBuy()`.
6.  Only 10% of the accumulated RSR will go to the DAO, which is effectively 1% of the total revenue.
7.  Repeat this process as needed.



