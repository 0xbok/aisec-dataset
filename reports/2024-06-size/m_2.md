## [M] Users can not to buy/sell minimum credit allowed due to exactAmountIn condition

<relative_path_091409:src/libraries/actions/BuyCreditMarket.sol#L91><relative_path_091409:src/libraries/actions/SellCreditMarket.sol#L93>

### Impact

The minimum credit user can buy or sell can be gotten from `state.riskConfig.minimumCreditBorrowAToken` which was set as `5e6`. However, in `buyCreditMarket` and `sellCreditMarket` user can not buy or sell minimun credit allowed or small amount above it due to the `exactAmountIn` condition he chose.

**In `buyCreditMarket`:** when user set `params.exactAmountIn = true`, The `params.amount` value will be cash he want to use to buy credit. Since the `params.amount` value is cash it can be set less than `state.riskConfig.minimumCreditBorrowAToken` (5e6) as long as when the value get converted to credit it will reach the `state.riskConfig.minimumCreditBorrowAToken` value. But, unfortunately, in `validateBuyCreditMarket()` whenever `params.amount` is less than `state.riskConfig.minimumCreditBorrowAToken` the transaction will revert due to below code present in the function.

```javascript
if (params.amount < state.riskConfig.minimumCreditBorrowAToken) {
    revert Errors.CREDIT_LOWER_THAN_MINIMUM_CREDIT(params.amount, state.riskConfig.minimumCreditBorrowAToken);
}
```

For example, the cash user can use to buy minimum credit allowed (`5e6`) can be calculated as in the code below, And the value should be less than the minimum credit allowed (`5e6`).

```javascript
uint256 minimumCash = Math.mulDivUp(5e6, PERCENT, PERCENT + ratePerTenor);
```

**In `sellCreditMarket`:** when user set `params.exactAmountIn = false`, The `params.amount` will be the exact cash he want to receive. But he will also not be able to set the `params.amount` value to be less than `state.riskConfig.minimumCreditBorrowAToken` value due to the below code present in `validateSellCreditMarket()`.

    if (params.amount < state.riskConfig.minimumCreditBorrowAToken) {
        revert Errors.CREDIT_LOWER_THAN_MINIMUM_CREDIT(params.amount, state.riskConfig.minimumCreditBorrowAToken);
    }

### Proof of Concept

**For `BuyCreditMarket`:** Copy and paste below code in `/test/local/actions/BuyCreditMarket.t.sol`:

```javascript
function testFail_UserCanNotBuyMinimumCredit() public {
    // alice deposit weth
    _deposit(alice, weth, 100e18);

    // bob deposit usdc
    _deposit(bob, usdc, 200e6);

    // alice create a borrow offer
    _sellCreditLimit(alice, 0.03e18, 365 days);

    // calculate cash from minimum  credit borrowAToken allowed = 5e6
    uint256 minimumCash = Math.mulDivUp(5e6, PERCENT, PERCENT + 0.03e18);

    // Expect revert with an error CREDIT_LOWER_THAN_MINIMUM_CREDIT
    uint256 debtPositionId = _buyCreditMarket(bob, alice, minimumCash, 365 days, true);
}
```

Then run the test with below command, the test should pass because it will revert with an error `Errors.CREDIT_LOWER_THAN_MINIMUM_CREDIT`.

```
forge test --mt testFail_UserCanNotBuyMinimumCredit
```

**For `SellCreditMarket`:** Copy and paste below code in `/test/local/actions/SellCreditMarket.t.sol`:

```javascript
function testFail_UserCanNotSellMinimumCredit() public {
    // alice deposit usdc
    _deposit(alice, usdc, 200e6);

    // bob deposit weth
    _deposit(bob, weth, 100e18);

    // alice create a loan offer
    _buyCreditLimit(alice, block.timestamp + 365 days, YieldCurveHelper.pointCurve(365 days, 0.03e18));

    // calculate cash from minimum  credit borrowAToken allowed = 5e6
    uint256 minimumCreditInCash = Math.mulDivUp(5e6, PERCENT, PERCENT + 0.03e18);

    // Expect revert with an error CREDIT_LOWER_THAN_MINIMUM_CREDIT
    uint256 debtPositionId = _sellCreditMarket(bob, alice, RESERVED_ID, minimumCreditInCash, 365 days, false);
}
```

Then run the test with below command, the test should pass because it will revert with an error `Errors.CREDIT_LOWER_THAN_MINIMUM_CREDIT`.

```
forge test --mt testFail_UserCanNotSellMinimumCredit
```



